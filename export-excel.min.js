/**
 *	export-excel.js
 *	@author <a href="mailto:patrick.holynova@gmail.com">Patrick</a>
 */
(function(c,b){var e="Export Excel Tool: Please use IE 8+, FF 3.5+, Chrome, Saf or Opera";if(!c.querySelectorAll){console.info(e);return}var d='<span class="button-blue"><input type="button" id="xls_export_excel" value="Export Excel"></span>',a='<form style="display: none;" id="searchresulttoexcelform" method="post" enctype="multipart/form-data" action="http://9.115.144.33/ecm_extensions/exportexcel/generateexcel.php"><input name="contenttoexcel" id="contenttoexcel" /></form>';byId=function(f){return c.getElementById(f)},connect=function(g,f,h){if(c.addEventListener){return g.addEventListener(f,h)}else{if(c.attachEvent){return g.attachEvent("on"+f,h)}else{console.info(e)}}},init=function(){var g=c.querySelectorAll("table"),f=g.length;g[f-1].querySelectorAll("td")[0].innerHTML+=d,c.querySelectorAll("#masthead")[0].innerHTML+=a;connect(byId("xls_export_excel"),"click",function(){generate()})},generate=function(){var h={};h.title=["skey","uid","status","title","owner","version","modified"];h.items=[];var f=function(k){return[k.querySelectorAll("td[headers=c_select] input")[1].value,k.querySelectorAll("td[headers=c_select] input")[1].name.substr(4),k.querySelectorAll("td[headers=c_status] td")[1].innerHTML.replace(/^\s|\&nbsp;/g,""),k.querySelectorAll("td[headers=c1] a")[1].innerHTML.replace(/'/g,"%%SQUOT%%").replace(/"/g,"%%DQUOT%%"),k.querySelectorAll("td[headers=c2]")[0].innerHTML,k.querySelectorAll("td[headers=c3]")[0].innerHTML,k.querySelectorAll("td[headers=c4]")[0].innerHTML]};var g=c.querySelectorAll("form[name=myForm] table tbody")[0].children,j=g.length;for(i=0;i<j;i++){h.items.push(f(g[i]))}byId("contenttoexcel").value=b.JSON.stringify(h);byId("searchresulttoexcelform").submit();byId("xls_export_excel").disabled=true;setTimeout(function(){byId("xls_export_excel").disabled=false},8000)};init()})(document,window);